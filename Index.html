<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NovaCoder ‚Ä¢ build your own layout</title>
    <!-- Font Awesome, Google Fonts, Fira Code -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:opsz,wght@14..32,400;14..32,500;14..32,600;14..32,700&family=Fira+Code:wght@400;500&display=swap" rel="stylesheet">
    <style>
        /* === RESET + VARIABLES === */
        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Inter', sans-serif;
            background: linear-gradient(145deg, #f0f5fa 0%, #e3eef8 100%);
            min-height: 100vh;
            color: #1a2b3c;
            line-height: 1.5;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255,255,255,0.5);
            border-radius: 2rem;
            box-shadow: 0 20px 40px -12px rgba(0,20,40,0.2);
        }

        .glass-panel {
            background: rgba(255, 255, 255, 0.5);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            border: 1px solid rgba(255,255,255,0.7);
            border-radius: 1.5rem;
        }

        /* navigation */
        .nav-link {
            position: relative;
            font-weight: 500;
            color: #1e3b5c;
            transition: color 0.2s;
            cursor: pointer;
        }
        .nav-link.active::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #ec4899);
            border-radius: 4px;
            animation: slideIn 0.3s ease;
        }
        @keyframes slideIn {
            from { width: 0; opacity: 0; }
            to { width: 100%; opacity: 1; }
        }

        .btn-primary {
            background: linear-gradient(135deg, #3b82f6, #8b5cf6);
            color: white;
            border: none;
            padding: 0.7rem 2rem;
            border-radius: 3rem;
            font-weight: 600;
            box-shadow: 0 10px 18px -8px #3b82f680;
            transition: 0.2s;
            cursor: pointer;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 18px 25px -10px #3b82f6;
        }

        .btn-outline {
            background: transparent;
            border: 1.5px solid #3b82f6;
            color: #1e3b5c;
            font-weight: 600;
            padding: 0.5rem 1.6rem;
            border-radius: 3rem;
            transition: 0.2s;
            cursor: pointer;
        }

        /* language pills */
        .lang-pill {
            display: inline-block;
            padding: 0.4rem 1.2rem;
            background: rgba(255,255,255,0.6);
            border-radius: 40px;
            font-size: 0.9rem;
            font-weight: 600;
            border: 1px solid white;
            cursor: pointer;
            transition: 0.15s;
        }
        .lang-pill.selected {
            background: #3b82f6;
            color: white;
            border-color: #2563eb;
            box-shadow: 0 6px 12px -6px #3b82f6;
        }

        /* === adjustable boxes ‚Äî the user decides sizes === */
        .editor-box {
            background: #0e1e2f;
            border-radius: 1.2rem;
            border: 2px solid rgba(255,255,255,0.15);
            box-shadow: inset 0 4px 10px rgba(0,0,0,0.2);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            height: 100%;
            width: 100%;
            resize: both;           /* üü¢ user can drag to resize any box */
            overflow: auto;
            min-width: 180px;
            min-height: 120px;
            max-width: 100%;
            max-height: 100%;
        }

        .editor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.4rem 0.8rem;
            background: rgba(10,23,37,0.6);
            border-bottom: 1px solid #2d3b4f;
            color: #b0c4de;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: move;            /* hint for move (not implemented fully, but resize works) */
            user-select: none;
        }

        .editor-content {
            display: flex;
            flex: 1;
            min-height: 0;           /* essential for flex children to scroll */
            background: #0e1e2f;
        }

        .line-numbers {
            padding: 0.8rem 0.3rem;
            text-align: right;
            color: #5f7a97;
            font-family: 'Fira Code', monospace;
            font-size: 13px;
            user-select: none;
            border-right: 1px solid #2d3b4f;
            background: #0a1725;
            min-width: 36px;
        }

        .code-area {
            flex: 1;
            background: transparent;
            border: none;
            padding: 0.8rem;
            font-family: 'Fira Code', monospace;
            font-size: 13px;
            color: #e3eaf0;
            resize: none;
            outline: none;
            line-height: 1.5;
        }

        .preview-box {
            background: white;
            border-radius: 1.2rem;
            border: 2px solid rgba(255,255,255,0.5);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            resize: both;
            overflow: hidden;
            min-width: 200px;
            min-height: 150px;
            display: flex;
            flex-direction: column;
        }

        .preview-header {
            padding: 0.3rem 0.8rem;
            background: #eef2f6;
            border-bottom: 1px solid #ccc;
            font-weight: 600;
            font-size: 0.85rem;
        }
        .dark-theme .preview-header {
            background: #2d3b4f;
            color: #e5e9f0;
        }

        .preview-iframe {
            width: 100%;
            flex: 1;
            border: none;
            background: white;
        }

        /* layout container: a GRID where every cell is freely adjustable */
        .adjustable-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;  /* two columns, but boxes inside can overflow */
            gap: 1.2rem;
            margin-top: 1rem;
            min-height: 550px;
            height: auto;
        }

        .grid-item {
            display: flex;
            flex-direction: column;
        }

        /* full-width item */
        .grid-item-wide {
            grid-column: span 2;
        }

        .flex-row {
            display: flex;
            gap: 1.2rem;
            flex-wrap: wrap;
        }

        /* theme toggle */
        .theme-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background: white;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            z-index: 100;
            transition: 0.2s;
        }
        .theme-toggle:hover { transform: scale(1.1); }
        .theme-toggle.dark { background: #1e2a3a; color: white; }

        body.dark-theme {
            background: linear-gradient(145deg, #1a2634 0%, #0f1a24 100%);
            color: #e5e9f0;
        }
        body.dark-theme .glass-card { background: rgba(30, 40, 54, 0.8); border-color: rgba(255,255,255,0.1); }
        body.dark-theme .glass-panel { background: rgba(30, 40, 54, 0.5); border-color: rgba(255,255,255,0.1); }
        body.dark-theme .nav-link { color: #b0c4de; }
        body.dark-theme .preview-box { background: #1e2a3a; border-color: #4a5c72; }
        body.dark-theme .preview-header { background: #1e2a3a; color: #ddd; }

        /* footer etc */
        .footer-link { color: #2c405c; text-decoration: none; font-weight:500; } 
        .footer-link:hover { color:#3b82f6; }
        body.dark-theme .footer-link { color: #b0c4de; }

        .fade-in { animation: fadeIn 0.5s cubic-bezier(0.23, 1, 0.32, 1); }
        @keyframes fadeIn { 0% { opacity: 0; transform: translateY(6px); } 100% { opacity: 1; transform: translateY(0); } }

        /* utilities */
        .grid { display: grid; } .grid-cols-1 { grid-template-columns: repeat(1,1fr); } 
        @media (min-width:768px){ .md\:grid-cols-2 { grid-template-columns: repeat(2,1fr); } } 
        @media (min-width:768px){ .md\:grid-cols-4 { grid-template-columns: repeat(4,1fr); } }
        .gap-4 { gap: 1rem; } .gap-6 { gap: 1.5rem; } .space-y-2 > * + * { margin-top: 0.5rem; }
        .p-3 { padding:0.75rem; } .p-4 { padding:1rem; } .p-5{ padding:1.25rem; } .p-6{ padding:1.5rem; } .p-8{ padding:2rem; } 
        .px-4{ padding-left:1rem; padding-right:1rem; } .px-6{ padding-left:1.5rem; padding-right:1.5rem; } 
        .py-1{ padding-top:0.25rem; padding-bottom:0.25rem; } .py-5{ padding-top:1.25rem; padding-bottom:1.25rem; } 
        .mb-2{ margin-bottom:0.5rem; } .mb-3{ margin-bottom:0.75rem; } .mb-4{ margin-bottom:1rem; } .mb-6{ margin-bottom:1.5rem; } 
        .mt-4{ margin-top:1rem; } .mt-12{ margin-top:3rem; }
        .flex { display: flex; } .items-center { align-items: center; } .justify-between { justify-content: space-between; } 
        .flex-wrap { flex-wrap: wrap; } .gap-2 { gap:0.5rem; } .gap-3 { gap:0.75rem; }
        .text-sm { font-size:0.875rem; } .text-base { font-size:1rem; } .text-xl { font-size:1.25rem; } 
        .text-2xl { font-size:1.5rem; } .text-3xl { font-size:1.875rem; } .text-4xl { font-size:2.25rem; } 
        .font-semibold { font-weight:600; } .font-bold { font-weight:700; }
        .w-full { width:100%; } .h-20 { height:5rem; } .w-20 { width:5rem; } .mx-auto { margin-left:auto; margin-right:auto; } 
        .max-w-xl { max-width:36rem; } .text-blue-500 { color: #3b82f6; } .text-green-600 { color:#16a34a; } 
        [data-page] { cursor: pointer; }
    </style>
</head>
<body>
    <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-5" style="max-width: 1400px; margin: 0 auto; padding: 1.5rem 2rem;">
        
        <header class="glass-card flex items-center justify-between flex-wrap gap-4 px-6 py-4 mb-6 fade-in">
            <div class="flex items-center gap-3">
                <i class="fas fa-code text-3xl" style="color: #3b82f6;"></i>
                <span class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">NovaCoder</span>
            </div>
            <nav class="flex gap-6 text-base flex-wrap">
                <a class="nav-link active" data-page="compiler">Compiler</a>
                <a class="nav-link" data-page="htmlcss">HTML/CSS/JS</a>
                <a class="nav-link" data-page="about">About Us</a>
                <a class="nav-link" data-page="blog">Blog</a>
                <a class="nav-link" data-page="contact">Contact</a>
            </nav>
            <div>
                <button class="btn-outline text-sm"><i class="far fa-user mr-2"></i>Sign in</button>
            </div>
        </header>

        <main id="page-content" class="fade-in"></main>

        <footer class="glass-panel grid grid-cols-1 md:grid-cols-4 gap-6 p-8 mt-12 text-sm">
            <div><h4 class="font-semibold text-base mb-3">NovaCoder</h4><p class="text-gray-700">Adjustable boxes ‚Äì you decide size</p></div>
            <div><h4 class="font-semibold mb-3">Explore</h4><ul class="space-y-2"><li><a class="footer-link" data-page="compiler">Compiler</a></li><li><a class="footer-link" data-page="htmlcss">HTML/CSS/JS</a></li><li><a class="footer-link" data-page="blog">Blog</a></li></ul></div>
            <div><h4 class="font-semibold mb-3">Company</h4><ul class="space-y-2"><li><a class="footer-link" data-page="about">About Us</a></li><li><a class="footer-link" data-page="contact">Contact</a></li></ul></div>
            <div><h4 class="font-semibold mb-3">Connect</h4><div class="flex gap-4 text-xl"><i class="fab fa-github hover:text-blue-600"></i><i class="fab fa-twitter hover:text-sky-500"></i><i class="fab fa-discord hover:text-indigo-600"></i></div></div>
        </footer>
    </div>

    <!-- Theme Toggle -->
    <div class="theme-toggle" id="themeToggle">
        <i class="fas fa-moon"></i>
    </div>

    <!-- templates ‚Äì each box is individually resizable (resize: both) -->
    <div id="page-templates" style="display: none;">
        <!-- COMPILER PAGE ‚Äì every box adjustable -->
        <div id="template-compiler">
            <div class="mb-4">
                <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-700 to-purple-700 bg-clip-text text-transparent">build your own layout</h1>
                <p class="text-gray-600">‚ö° grab the corner of any box ‚Üí drag to resize. code, output, everything.</p>
            </div>
            <div class="glass-panel p-3 mb-4 flex flex-wrap items-center gap-2">
                <span class="text-sm font-semibold mr-1">Language:</span>
                <span class="lang-pill selected" data-lang="python">Python</span><span class="lang-pill" data-lang="javascript">JS</span><span class="lang-pill" data-lang="java">Java</span><span class="lang-pill" data-lang="cpp">C++</span><span class="lang-pill" data-lang="csharp">C#</span><span class="lang-pill" data-lang="php">PHP</span><span class="lang-pill" data-lang="ruby">Ruby</span><span class="lang-pill" data-lang="go">Go</span><span class="lang-pill" data-lang="rust">Rust</span><span class="lang-pill" data-lang="swift">Swift</span>
            </div>

            <!-- ADJUSTABLE BOXES: placed in a flexible grid, each box has resize:both -->
            <div class="adjustable-grid">
                <!-- left column: code box -->
                <div class="grid-item">
                    <div class="editor-box" style="height: 350px; width: 100%;">
                        <div class="editor-header">
                            <span><i class="fas fa-pen-nib text-blue-400 mr-2"></i>code editor</span>
                            <div>
                                <button id="font-increase" class="btn-outline text-xs py-1 px-2 mr-1"><i class="fas fa-search-plus"></i></button>
                                <button id="font-decrease" class="btn-outline text-xs py-1 px-2"><i class="fas fa-search-minus"></i></button>
                            </div>
                        </div>
                        <div class="editor-content">
                            <div class="line-numbers" id="lineNumbers">1</div>
                            <textarea id="code-editor-area" class="code-area" placeholder="print('Hello world')" spellcheck="false">print("Adjustable boxes!")</textarea>
                        </div>
                    </div>
                </div>

                <!-- right column: output box, also adjustable -->
                <div class="grid-item">
                    <div class="editor-box" style="height: 350px; width: 100%; background: #0e1e2f;">
                        <div class="editor-header">
                            <span><i class="fas fa-terminal text-green-400 mr-2"></i>output</span>
                            <button id="clear-output" class="btn-outline text-xs py-1 px-3"><i class="fas fa-eraser"></i></button>
                        </div>
                        <div class="editor-content" style="background: #0e1e2f; color:#d6dee8;">
                            <div class="line-numbers" style="background: #0a1725;">></div>
                            <pre id="output-console" class="code-area" style="white-space: pre-wrap; overflow: auto;">‚ñ∂ ready</pre>
                        </div>
                    </div>
                </div>

                <!-- full-width row: extra controls / run button (can also be box but we just put a nice bar) -->
                <div class="grid-item-wide" style="margin-top: 0.5rem;">
                    <div class="flex items-center justify-between glass-panel p-3">
                        <span class="text-sm text-gray-600"><i class="fas fa-arrows-alt mr-2"></i>drag corners to reshape</span>
                        <button id="run-code-btn" class="btn-primary text-sm py-2 px-6"><i class="fas fa-play mr-2"></i>run code (Ctrl+Enter)</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- HTML/CSS/JS PAGE ‚Äì each editor and preview individually resizable -->
        <div id="template-htmlcss">
            <h2 class="text-3xl font-bold mb-2">HTML / CSS / JS ¬∑ freeform</h2>
            <p class="text-gray-600 mb-4">üñ±Ô∏è each box is adjustable ‚Äì drag bottom‚Äëright corner. live preview updates as you type.</p>

            <div class="flex-row">
                <!-- left stack of three adjustable editor boxes -->
                <div style="flex: 2; min-width: 300px; display: flex; flex-direction: column; gap: 1.2rem;">
                    <!-- HTML box -->
                    <div class="editor-box" style="height: 200px; width: 100%;">
                        <div class="editor-header"><span><i class="fab fa-html5 text-orange-400 mr-2"></i>HTML</span></div>
                        <div class="editor-content">
                            <div class="line-numbers" id="htmlLineNumbers">1</div>
                            <textarea id="html-input" class="code-area" placeholder="HTML" spellcheck="false"><div class="box">‚ú® resize me</div></textarea>
                        </div>
                    </div>
                    <!-- CSS box -->
                    <div class="editor-box" style="height: 200px; width: 100%;">
                        <div class="editor-header"><span><i class="fab fa-css3-alt text-blue-300 mr-2"></i>CSS</span></div>
                        <div class="editor-content">
                            <div class="line-numbers" id="cssLineNumbers">1</div>
                            <textarea id="css-input" class="code-area" placeholder="CSS" spellcheck="false">.box { background: #8b5cf6; color: white; padding: 1.5rem; border-radius: 30px; }</textarea>
                        </div>
                    </div>
                    <!-- JS box -->
                    <div class="editor-box" style="height: 200px; width: 100%;">
                        <div class="editor-header"><span><i class="fab fa-js text-yellow-400 mr-2"></i>JavaScript</span></div>
                        <div class="editor-content">
                            <div class="line-numbers" id="jsLineNumbers">1</div>
                            <textarea id="js-input" class="code-area" placeholder="JS" spellcheck="false">document.querySelector('.box')?.addEventListener('click',()=>alert('live'))</textarea>
                        </div>
                    </div>
                </div>

                <!-- right side: preview box, also adjustable -->
                <div style="flex: 1; min-width: 280px;">
                    <div class="preview-box" style="height: 450px; width: 100%; display: flex; flex-direction: column;">
                        <div class="preview-header"><i class="fas fa-eye mr-2"></i>live preview ‚Äî drag corner</div>
                        <iframe id="live-preview" class="preview-iframe" sandbox="allow-scripts allow-same-origin" title="preview"></iframe>
                    </div>
                </div>
            </div>
        </div>

        <!-- other pages unchanged -->
        <div id="template-about">
            <h2 class="text-3xl font-bold mb-2">About Us</h2><p class="text-gray-600 mb-6">we make adjustable tools</p>
            <div class="grid md:grid-cols-3 gap-6">
                <div class="glass-panel p-6 text-center"><div class="w-20 h-20 rounded-full bg-blue-100 mx-auto flex text-4xl">üë©‚Äçüíª</div><h3 class="font-semibold mt-4">Elena</h3><p class="text-sm">founder</p></div>
                <div class="glass-panel p-6 text-center"><div class="w-20 h-20 rounded-full bg-purple-100 mx-auto flex text-4xl">üßë‚Äçüîß</div><h3 class="font-semibold mt-4">Marcus</h3><p class="text-sm">compiler engineer</p></div>
                <div class="glass-panel p-6 text-center"><div class="w-20 h-20 rounded-full bg-pink-100 mx-auto flex text-4xl">üé®</div><h3 class="font-semibold mt-4">Sophia</h3><p class="text-sm">design</p></div>
            </div>
        </div>
        <div id="template-blog">
            <h2 class="text-3xl font-bold mb-2">blog</h2><p class="text-gray-600 mb-6">latest</p>
            <div class="grid gap-4 md:grid-cols-2"><div class="glass-panel p-5"><span class="font-semibold">‚ö° Piston API tips</span><p class="text-sm mt-2">how to handle many languages...</p></div><div class="glass-panel p-5"><span class="font-semibold">üé® adjustable splitters</span><p class="text-sm mt-2">we added drag-to-resize</p></div></div>
        </div>
        <div id="template-contact">
            <h2 class="text-3xl font-bold mb-2">contact</h2><p class="text-gray-600 mb-6">we're here</p>
            <div class="glass-card max-w-xl mx-auto p-6"><input class="bg-white/60 w-full rounded-full px-4 py-2 mb-3" placeholder="name"><input class="bg-white/60 w-full rounded-full px-4 py-2 mb-3" placeholder="email"><textarea class="bg-white/60 w-full rounded-2xl px-4 py-2" rows="3"></textarea><button class="btn-primary mt-4">Send</button></div>
        </div>
    </div>

    <script>
        (function() {
            // Page switching
            const templates = {
                compiler: document.getElementById('template-compiler').innerHTML,
                htmlcss: document.getElementById('template-htmlcss').innerHTML,
                about: document.getElementById('template-about').innerHTML,
                blog: document.getElementById('template-blog').innerHTML,
                contact: document.getElementById('template-contact').innerHTML
            };
            const contentDiv = document.getElementById('page-content');
            const navLinks = document.querySelectorAll('.nav-link');
            const footerLinks = document.querySelectorAll('.footer-link');

            function setActivePage(pageId) {
                navLinks.forEach(link => link.classList.toggle('active', link.dataset.page === pageId));
                contentDiv.innerHTML = templates[pageId] || templates.compiler;

                if (pageId === 'compiler') { 
                    attachCompilerEvents(); 
                    attachLineNumbers('code-editor-area', 'lineNumbers');
                }
                if (pageId === 'htmlcss') { 
                    attachHtmlCssEvents(); 
                    attachLineNumbers('html-input', 'htmlLineNumbers');
                    attachLineNumbers('css-input', 'cssLineNumbers');
                    attachLineNumbers('js-input', 'jsLineNumbers');
                    setupLivePreview();   // live update
                }
            }

            navLinks.forEach(link => link.addEventListener('click', (e) => { e.preventDefault(); setActivePage(link.dataset.page); }));
            footerLinks.forEach(link => link.addEventListener('click', (e) => { e.preventDefault(); setActivePage(link.dataset.page); }));

            // Line numbers (simple)
            function attachLineNumbers(textareaId, lineNumbersId) {
                const textarea = document.getElementById(textareaId);
                const lineNumbers = document.getElementById(lineNumbersId);
                if (!textarea || !lineNumbers) return;
                function updateLineNumbers() {
                    const lines = textarea.value.split('\n').length;
                    let numbers = '';
                    for (let i = 1; i <= lines; i++) numbers += i + '\n';
                    lineNumbers.innerText = numbers;
                }
                textarea.addEventListener('input', updateLineNumbers);
                textarea.addEventListener('scroll', () => lineNumbers.scrollTop = textarea.scrollTop);
                updateLineNumbers();
            }

            // Font controls for compiler
            let currentFontSize = 13;
            function attachFontControls() {
                const increase = document.getElementById('font-increase');
                const decrease = document.getElementById('font-decrease');
                const codeArea = document.getElementById('code-editor-area');
                const lineNums = document.getElementById('lineNumbers');
                if (increase && codeArea) {
                    increase.addEventListener('click', () => {
                        currentFontSize = Math.min(22, currentFontSize + 2);
                        codeArea.style.fontSize = currentFontSize + 'px';
                        if (lineNums) lineNums.style.fontSize = currentFontSize + 'px';
                    });
                }
                if (decrease && codeArea) {
                    decrease.addEventListener('click', () => {
                        currentFontSize = Math.max(10, currentFontSize - 2);
                        codeArea.style.fontSize = currentFontSize + 'px';
                        if (lineNums) lineNums.style.fontSize = currentFontSize + 'px';
                    });
                }
            }

            // Keyboard shortcut Ctrl+Enter
            function attachKeyboardShortcuts() {
                document.addEventListener('keydown', (e) => {
                    if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                        const runBtn = document.getElementById('run-code-btn');
                        if (runBtn) { e.preventDefault(); runBtn.click(); }
                    }
                });
            }

            // Theme toggle
            function attachThemeToggle() {
                const toggle = document.getElementById('themeToggle');
                const body = document.body;
                const saved = localStorage.getItem('theme');
                if (saved === 'dark') { body.classList.add('dark-theme'); toggle.innerHTML = '<i class="fas fa-sun"></i>'; }
                toggle.addEventListener('click', () => {
                    body.classList.toggle('dark-theme');
                    if (body.classList.contains('dark-theme')) { toggle.innerHTML = '<i class="fas fa-sun"></i>'; localStorage.setItem('theme', 'dark'); } 
                    else { toggle.innerHTML = '<i class="fas fa-moon"></i>'; localStorage.setItem('theme', 'light'); }
                });
            }

            // Compiler logic (piston)
            function attachCompilerEvents() {
                const pills = document.querySelectorAll('.lang-pill');
                const runBtn = document.getElementById('run-code-btn');
                const codeArea = document.getElementById('code-editor-area');
                const outputDiv = document.getElementById('output-console');
                let currentLang = 'python';

                pills.forEach(p => {
                    p.addEventListener('click', () => {
                        pills.forEach(pill => pill.classList.remove('selected'));
                        p.classList.add('selected');
                        currentLang = p.dataset.lang;
                        const samples = {
                            python: 'print("Hello, world!")',
                            javascript: 'console.log("Hello world");',
                            java: 'public class Main { public static void main(String[] args) { System.out.println("Hello"); } }',
                            cpp: '#include <iostream>\nint main() { std::cout << "Hello"; }',
                            csharp: 'using System; class P { static void Main() { Console.WriteLine("Hello"); } }',
                            php: '<?php echo "Hello"; ?>',
                            ruby: 'puts "Hello"',
                            go: 'package main\nimport "fmt"\nfunc main() { fmt.Println("Hello") }',
                            rust: 'fn main() { println!("Hello"); }',
                            swift: 'print("Hello")'
                        };
                        if (samples[currentLang]) codeArea.value = samples[currentLang];
                        codeArea.dispatchEvent(new Event('input'));
                    });
                });

                if (runBtn) {
                    runBtn.addEventListener('click', async () => {
                        const code = codeArea.value;
                        if (!code) return;
                        outputDiv.innerText = '‚è≥ compiling...';
                        const langMap = { python:'python3', javascript:'javascript', java:'java', cpp:'cpp', csharp:'csharp', php:'php', ruby:'ruby', go:'go', rust:'rust', swift:'swift' };
                        const language = langMap[currentLang] || 'python3';
                        try {
                            const res = await fetch('https://emkc.org/api/v2/piston/execute', {
                                method: 'POST',
                                headers: { 'Content-Type': 'application/json' },
                                body: JSON.stringify({ language, version: '*', files: [{ content: code }] })
                            });
                            const data = await res.json();
                            outputDiv.innerText = data.run ? (data.run.output || data.run.stdout || 'no output') : ('error: ' + (data.message || 'unknown'));
                        } catch(err) {
                            outputDiv.innerText = 'network error: ' + err.message;
                        }
                    });
                }
                attachFontControls();
                document.getElementById('clear-output')?.addEventListener('click', ()=>{
                    if(outputDiv) outputDiv.innerText = '‚ñ∂ ready';
                });
            }

            // HTML preview live
            function setupLivePreview() {
                const htmlIn = document.getElementById('html-input');
                const cssIn = document.getElementById('css-input');
                const jsIn = document.getElementById('js-input');
                const iframe = document.getElementById('live-preview');
                if (!htmlIn || !cssIn || !jsIn || !iframe) return;

                function updatePreview() {
                    const doc = `<!DOCTYPE html><html><head><style>${cssIn.value || ''}</style></head><body>${htmlIn.value || ''}<script>${jsIn.value || ''}<\/script></body></html>`;
                    iframe.srcdoc = doc;
                }
                htmlIn.addEventListener('input', updatePreview);
                cssIn.addEventListener('input', updatePreview);
                jsIn.addEventListener('input', updatePreview);
                updatePreview();
            }

            function attachHtmlCssEvents() { /* nothing else needed */ }

            attachKeyboardShortcuts();
            attachThemeToggle();
            setActivePage('compiler');
        })();
    </script>
</body>
</html>
